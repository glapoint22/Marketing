<div class="filter-container" [ngClass]="{'padding' : showContent}">
  <div class="caption">{{caption}}</div>

  <!-- Arrow -->
  <div (click)="showContent = !showContent" class="arrow-container">
    <div class="arrow" [ngClass]="{'arrow-down' : showContent, 'arrow-right' : !showContent}"></div>
  </div>

  <!-- Content -->
  <div *ngIf="showContent">
    <!-- Any Category -->
    <div *ngIf="currentCategory > 0 && query != undefined">
      <i class="fa fa-angle-left" aria-hidden="true"></i>
      <div class="pointer inline margin-top" (click)="filterService.setQueryParameters([{name: 'category', value: 0}], ['nicheId', 'page'])">Any Category</div>
    </div>


    <!-- List of categories -->
    <div *ngFor="let category of categories; let i = index">
      <!-- Display all categories or partial  -->
      <div *ngIf="!displayAllCategories ? i < 4 : categories.length">
        <i *ngIf="currentNiche > 0" class="fa fa-angle-left" aria-hidden="true"></i>
        <div style="display: inline-block" (click)="filterService.setQueryParameters([{name: 'category', value: category.id}], ['nicheId', 'page'])"
          [ngClass]="{'margin-top' : currentCategory == 0 || query == undefined, 'highlight' : currentNiche == null, 'pointer' : currentCategory == 0 || currentNiche > 0}">{{category.name}}</div>
        <span class="count">({{getProductCount(category)}})</span>

        <!-- List of niches per category -->
        <div *ngFor="let niche of category.niches; let j = index">
          <!-- Display all niches or partial -->
          <div *ngIf="!category.showAllNiches ? j < 4 : category.niches.length">
            <div [ngClass]="{'pointer' : currentNiche == null, 'highlight' : currentNiche != null}" class="margin-left" (click)="filterService.setQueryParameters([{name: 'nicheId', value: niche.id}, {name: 'category', value: category.id}], ['page'])">{{niche.name}}
              <span class="count">({{niche.productCount}})</span>
            </div>
          </div>
        </div>
        <!-- See more/See less niches -->
        <div *ngIf="category.niches.length > 4">
          <i class="fa niche" aria-hidden="true" [ngClass]="{'fa-angle-double-down' : !category.showAllNiches, 'fa-angle-double-up' : category.showAllNiches}"></i>
          <div class="see-more-less pointer" (click)="category.showAllNiches = !category.showAllNiches" [innerHtml]="!category.showAllNiches ? 'See More' : 'See Less'"></div>
        </div>

      </div>
    </div>
    <!-- See all/See fewer categories -->
    <div *ngIf="categories.length > 4">
      <i class="fa" aria-hidden="true" [ngClass]="{'fa-angle-double-down' : !displayAllCategories, 'fa-angle-double-up' : displayAllCategories}"></i>
      <div style="margin-top: 10px" class="see-more-less pointer" (click)="displayAllCategories = !displayAllCategories" [innerHtml]="!displayAllCategories ? 'See All ' + categories.length + ' Categories' : 'See Fewer Categories'"></div>
    </div>
  </div>
</div>